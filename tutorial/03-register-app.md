<!-- markdownlint-disable MD002 MD041 -->

В этом упражнении вы создайте регистрацию нового веб-приложения Azure AD с помощью Центра администрирования Azure Active Directory.

1. Откройте браузер и перейдите к [Центру администрирования Azure Active Directory](https://aad.portal.azure.com). Войдите с помощью **личной учетной записи** (т.е. учетной записи Microsoft) или **рабочей (учебной) учетной записи**.

1. Выберите **Azure Active Directory** на панели навигации слева, затем выберите **Регистрация приложений** в разделе **Управление**.

    ![Снимок экрана с регистрацией приложений ](./images/aad-portal-app-registrations.png)

1. Выберите **Новая регистрация**. На странице **"Регистрация приложения"** задайте значения следующим образом, где находится URL-адрес переадстройки ngrok, скопированный в `YOUR_NGROK_URL` предыдущем разделе.

    - Введите **имя** `Teams Graph Tutorial`.
    - Введите **поддерживаемые типы учетных записей** для **учетных записей в любом каталоге организаций и личных учетных записей Microsoft**.
    - В разделе **URI адрес перенаправления** введите значение в первом раскрывающемся списке `Web` и задайте значение `YOUR_NGROK_URL/authcomplete`.

    ![Снимок экрана: страница "Регистрация приложения"](./images/aad-register-an-app.png)

1. Нажмите **Зарегистрировать**. На странице **"Руководство по Teams Graph"** скопируйте значение ИД приложения **(клиента)** и сохраните его, оно потребуется вам на следующем этапе.

    ![Снимок экрана: ИД нового приложения для регистрации](./images/aad-application-id.png)

1. Выберите **Проверка подлинности** в разделе **Управление**. Найдите **раздел неявного предоставления** и в включить **маркеры доступа** и **маркеры ID.** Нажмите **Сохранить**.

1. Выберите **Сертификаты и секреты** в разделе **Управление**. Нажмите кнопку **Новый секрет клиента**. Введите значение  в описании, выберите один из параметров "Срок действия **истекает"** и выберите **"Добавить".**

1. Скопируйте значение секрета клиента, а затем покиньте эту страницу. Оно вам понадобится на следующем шаге.

    > [!IMPORTANT]
    > Это секрет клиента, он никогда не отображается еще раз, поэтому убедитесь, что вы скопировали его.

1. Выберите **разрешения API в** области **"Управление",** а затем **выберите "Добавить разрешение".**

1. Выберите **Microsoft Graph,** а затем **делегирование разрешений.**

1. Выберите следующие разрешения, а затем выберите **"Добавить разрешения".**

    - **Calendars.ReadWrite** — позволяет приложению читать и записывать данные в календарь пользователя.
    - **MailboxSettings.Read** — позволяет приложению получать часовой пояс, формат даты и формат времени пользователя из параметров почтового ящика.

    ![Снимок экрана с настроенными разрешениями](images/aad-configured-permissions.png)

## <a name="configure-teams-single-sign-on"></a>Настройка единого входов в Teams

В этом разделе вы обновим регистрацию приложения, чтобы поддерживать единый вход [в Teams.](/microsoftteams/platform/tabs/how-to/authentication/auth-aad-sso)

1. Выберите **"Показать API"**. Выберите **ссылку "Установить"** рядом с **URI ИД приложения.** Вставьте доменное имя URL-адреса переадружения ngrok (с косой чертой "/" в конце) между двойной косой чертой и GUID. Весь ИД должен выглядеть примерно так: `api://50153897dd4d.ngrok.io/ae7d8088-3422-4c8c-a351-6ded0f21d615` .

1. В разделе **"Области", определяемом этим API,** выберите **"Добавить область".** Заполните поля следующим образом и выберите **"Добавить область".**

    - **Имя области:**`access_as_user`
    - **Кто может дать согласие?: администраторы и пользователи**
    - **Отображаемая имя согласия администратора:**`Access the app as the user`
    - **Описание согласия администратора:**`Allows Teams to call the app's web APIs as the current user.`
    - **Отображаемая имя согласия пользователя:**`Access the app as you`
    - **Описание согласия пользователя:**`Allows Teams to call the app's web APIs as you.`
    - **Состояние: включено**

    ![Снимок экрана с формой "Добавление области"](images/aad-add-scope.png)

1. В разделе **"Авторизованные клиентские приложения"** выберите **"Добавить клиентские приложения".** Введите ИД клиента из следующего списка, введите область в разрешенных разрешениях и выберите **"Добавить приложение".** Повторите этот процесс для каждого из клиентских ИД в списке.

    - `1fec8e78-bce4-4aaf-ab1b-5451cc387264` (Мобильное или настольное приложение Teams)
    - `5e3ce6c0-2b1f-4285-8d4b-75ee78787346` (Веб-приложение Teams)
